<template name="studyMandarinCard">
  <!-- Container for the target word and continue button -->
  <div style="min-height: 4em;">
    {{#if isCompleted}}
      <div style="text-align:center;">
        <button autofocus class="mandarin-continue btn btn-success btn-lg">
          Continue
        </button>
      </div>
    {{else}}
      <div style="text-align:center;"
        class="mandarin-header-{{headerStyle}}">
      <div class="dropdown" style="display: inline-block;">
        <span class="mandarin-target" data-toggle="dropdown" href="#"
          style="font-size: 200%;" >
          {{! activeBlock.chinese}}
        </span>
        {{#if showAnswer }}
          <span>&nbsp;&nbsp; Answer is: {{activeBlock.chinese}} {{answer}}</span>
        {{/if}}
        {{! This dictionary dropdown doesn't include pinyin }}
        <ul class="dropdown-menu mandarin-dict"
            role="menu" aria-labelledby="dLabel">
          {{#each activeBlock.definitions}}
            <li>Meaning:
            {{#each english}}
              <li>
                <a>{{this}}</a>
              </li>
            {{/each}}
            </li>
          {{/each}}
        </ul>
      </div>
      </div>
    {{/if}}
  </div>


  <div class="container" style="width: 800px; padding-top: 2em;">
    {{#each card.sentences}}
      <div class="mandarin-sentence row">

        {{! Chinese text on the left side. Main focus is here }}
        <div class="mandarin-task col-xs-8">
          {{#each blocks}}
            <div class="mandarin-block">
              <div class="mandarin-chinese">
                {{#if isGap}}
                  {{#if isActive}}
                    <input
                      autofocus
                      placeholder="{{chinese}}"
                      class="mandarin-input" style="width: {{len}}em;"/>
                  {{else}}
                    <input
                      disabled
                      placeholder="{{chinese}}"
                      class="mandarin-input" style="width: {{len}}em;"/>
                  {{/if}}
                {{else}}
                  {{#if isEscaped}}
                    {{text}}
                  {{else}}
                    <div class="dropdown">
                    <span class="dropdown-toggle"
                            id="dropdownMenu{{chinese}}"
                            data-toggle="dropdown" href="#">
                      {{chinese}}
                    </span>
                    <ul class="dropdown-menu mandarin-dict" role="menu"
                        aria-labelledby="dropdownMenu{{chinese}}">
                      {{#each key_value definitions}}
                        <li>{{value.pinyin}}
                          {{#each key_value value.english}}
                            <li>
                              <a class="mandarin-dict-select"
                                 data-sentence-id="{{../../sentenceId}}"
                                 data-block-id="{{../../blockId}}"
                                 data-pinyin-idx="{{ ../key }}"
                                 data-english-idx="{{ key }}"
                                 href="#">
                                {{value}}
                              </a>
                            </li>
                          {{/each}}
                        </li>
                      {{/each}}
                    </ul>
                    </div>
                  {{/if}}
                {{/if}}
              </div>
              <div class="mandarin-pinyin">
                {{#if showPinyin}}
                  {{selectedPinyin}}
                {{else}}
                  &nbsp;
                {{/if}}
              </div>
              <div class="mandarin-literal">
                {{#if literal}}
                {{literal}}
                {{else}}
                  &nbsp;
                {{/if}}
              </div>
            </div>
          {{/each}}
        </div>

        {{! English translation on the right hand side. }}
        <div class="mandarin-translation col-xs-4">
          {{english}}
        </div>
      </div>
    {{/each}}
    
  </div>
</template>
